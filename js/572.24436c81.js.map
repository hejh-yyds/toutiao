{"version":3,"file":"js/572.24436c81.js","mappings":"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","sources":["webpack://heima-toutiao/./src/views/login/index.vue","webpack://heima-toutiao/src/views/login/index.vue","webpack://heima-toutiao/./src/views/login/index.vue?75e3","webpack://heima-toutiao/./src/views/login/index.vue?a173","webpack://heima-toutiao/./src/api/user.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login-container\"},[_c('van-nav-bar',{staticClass:\"page-nav-bar\",attrs:{\"title\":\"登录/注册\"}},[_c('van-icon',{attrs:{\"slot\":\"left\",\"name\":\"cross\"},on:{\"click\":function($event){return _vm.$router.back()}},slot:\"left\"})],1),_c('van-form',{ref:\"loginForm\",on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"mobile\",\"label\":\"手机号\",\"placeholder\":\"请输入手机号\",\"type\":\"number\",\"maxlength\":\"11\",\"rules\":_vm.userFormRules.mobile},model:{value:(_vm.user.mobile),callback:function ($$v) {_vm.$set(_vm.user, \"mobile\", $$v)},expression:\"user.mobile\"}},[_c('i',{staticClass:\"toutiao toutiao-shouji\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('van-field',{attrs:{\"name\":\"code\",\"label\":\"验证码\",\"placeholder\":\"请输入验证码\",\"type\":\"number\",\"maxlength\":\"6\",\"rules\":_vm.userFormRules.code},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [(_vm.countDownVisible)?_c('van-count-down',{attrs:{\"time\":60 * 1000,\"format\":\" ss s\"},on:{\"finish\":function($event){_vm.countDownVisible = false}}}):_c('van-button',{staticClass:\"send-msg-btn\",attrs:{\"type\":\"default\",\"round\":\"\",\"native-type\":\"button\"},on:{\"click\":function($event){return _vm.sendMsg()}}},[_vm._v(\"发送验证码\")])]},proxy:true}]),model:{value:(_vm.user.code),callback:function ($$v) {_vm.$set(_vm.user, \"code\", $$v)},expression:\"user.code\"}},[_c('i',{staticClass:\"toutiao toutiao-yanzhengma\",attrs:{\"slot\":\"left-icon\"},slot:\"left-icon\"})]),_c('div',{staticClass:\"login-btn-wrap\"},[_c('van-button',{staticClass:\"login-btn\",attrs:{\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"登录\")])],1)],1),_vm._v(\" 登录页面 \")],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"login-container\">\r\n    <!-- 导航栏 -->\r\n    <van-nav-bar class=\"page-nav-bar\" title=\"登录/注册\">\r\n      <!-- 插槽，返回个人登录中心 -->\r\n\r\n      <van-icon name=\"cross\" slot=\"left\" @click=\"$router.back()\" />\r\n    </van-nav-bar>\r\n\r\n    <!-- 登录的表单 -->\r\n\r\n    <van-form @submit=\"onSubmit\" ref=\"loginForm\">\r\n      <van-field\r\n        v-model=\"user.mobile\"\r\n        name=\"mobile\"\r\n        label=\"手机号\"\r\n        placeholder=\"请输入手机号\"\r\n        type=\"number\"\r\n        maxlength=\"11\"\r\n        :rules=\"userFormRules.mobile\"\r\n      >\r\n        <!-- 图标插槽 -->\r\n        <i slot=\"left-icon\" class=\"toutiao toutiao-shouji\"></i>\r\n      </van-field>\r\n      <van-field\r\n        v-model=\"user.code\"\r\n        name=\"code\"\r\n        label=\"验证码\"\r\n        placeholder=\"请输入验证码\"\r\n        type=\"number\"\r\n        maxlength=\"6\"\r\n        :rules=\"userFormRules.code\"\r\n      >\r\n        <i slot=\"left-icon\" class=\"toutiao toutiao-yanzhengma\"></i>\r\n\r\n        <template #button>\r\n          <van-count-down\r\n            :time=\"60 * 1000\"\r\n            v-if=\"countDownVisible\"\r\n            format=\" ss s\"\r\n            @finish=\"countDownVisible = false\"\r\n          />\r\n\r\n          <van-button\r\n            v-else\r\n            type=\"default\"\r\n            round\r\n            class=\"send-msg-btn\"\r\n            native-type=\"button\"\r\n            @click=\"sendMsg()\"\r\n            >发送验证码</van-button\r\n          >\r\n        </template>\r\n      </van-field>\r\n      <div class=\"login-btn-wrap\">\r\n        <van-button block type=\"info\" native-type=\"submit\" class=\"login-btn\"\r\n          >登录</van-button\r\n        >\r\n      </div>\r\n    </van-form>\r\n    登录页面\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n// 导入用户登录的方法\r\nimport { login, sendCode } from '@/api/user.js'\r\nexport default {\r\n  name: 'loginIndex',\r\n\r\n  data () {\r\n    return {\r\n\r\n      // 是否显示倒计时\r\n      countDownVisible: false,\r\n\r\n      user: {\r\n        mobile: '',\r\n        code: ''\r\n      },\r\n\r\n      // 表单验证规则\r\n      userFormRules: {\r\n        mobile: [\r\n          {\r\n            required: true,\r\n            message: '请输入手机号'\r\n          },\r\n          {\r\n            pattern: /^1[3|5|7|8]\\d{9}$/,\r\n            message: '手机号格式错误'\r\n          }],\r\n\r\n        code: [\r\n          {\r\n            required: true,\r\n            message: '请输入验证码'\r\n          },\r\n          {\r\n            pattern: /^\\d{6}$/,\r\n            message: '验证码格式错误'\r\n          }]\r\n      }\r\n\r\n    }\r\n  },\r\n\r\n  methods: {\r\n\r\n    // 发送验证码的\r\n    async sendMsg () {\r\n      // 1.检验手机号\r\n      try {\r\n        // 返回值为promise对象\r\n        await this.$refs.loginForm.validate('mobile')\r\n      } catch (err) {\r\n        return console.log('验证失败')\r\n      }\r\n\r\n      // 2.验证通过，显示倒计时\r\n\r\n      this.countDownVisible = true\r\n\r\n      // 3.发送验证码\r\n\r\n      try {\r\n        await sendCode(this.user.mobile)\r\n        this.$toast.success('发送成功')\r\n      } catch (err) {\r\n        // 发送失败，隐藏倒计时\r\n        this.countDownVisible = false\r\n        if (err.response.status === 429) {\r\n          this.$toast.fail('发送次数太频繁，请稍后再试')\r\n        } else {\r\n          this.$toast.fail('发送失败，未知异常')\r\n        }\r\n      }\r\n    },\r\n\r\n    // 登录的功能\r\n    async onSubmit (values) {\r\n      // console.log('submit', values)\r\n\r\n      // 登录加载功能\r\n\r\n      this.$toast.loading({\r\n        duration: 0, // 持续展示 toast\r\n        message: '加载中...',\r\n        forbidClick: true // 是否禁止背景点击\r\n      })\r\n      try {\r\n        const { data: res } = await login(this.user)\r\n        console.log('登录成功', res)\r\n        this.$toast.success('登录成功')\r\n\r\n        // 存token到vuex和localstorage\r\n        this.$store.commit('setUser', res.data)\r\n\r\n        // 跳转到原来的页面，也就是我的页面\r\n        this.$router.back()\r\n      } catch (err) {\r\n        if (err.response.status === 400) {\r\n          console.log('登录失败', err)\r\n          this.$toast.fail('登录失败')\r\n        } else {\r\n          console.log('系统异常，稍后再试')\r\n          this.$toast.fail('系统异常，稍后再试')\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.login-container {\r\n  // 设置自定义插槽图标的大小\r\n  .toutiao {\r\n    font-size: 37px;\r\n  }\r\n\r\n  // 设置发送验证码按钮的样式\r\n\r\n  .send-msg-btn {\r\n    width: 152px;\r\n    height: 46px;\r\n    line-height: 46px;\r\n    background-color: #ededed;\r\n    font-size: 22px;\r\n    color: #666;\r\n\r\n    padding: 0;\r\n  }\r\n\r\n  .login-btn-wrap {\r\n    padding: 53px 33px;\r\n    .login-btn {\r\n      background-color: #6db4fb;\r\n      border: none;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1c24456e&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1c24456e&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1c24456e\",\n  null\n  \n)\n\nexport default component.exports","import request from './request.js'\r\n\r\n// 导入store\r\n// import store from '@/store/index.js'\r\n\r\n// 对外暴露一个用户登录的方法\r\nexport const login = data => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/authorizations',\r\n    data\r\n  })\r\n}\r\n\r\n// 发送验证码的方法\r\nexport const sendCode = mobile => {\r\n  return request({\r\n    method: 'GET',\r\n    url: `/v1_0/sms/codes/${mobile}`\r\n  })\r\n}\r\n\r\n// 获取用户个人信息\r\n// 需要携带token\r\n\r\nexport const getUserInfo = () => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user'\r\n    // headers: {\r\n    //   Authorization: `Bearer ${store.state.user.token}`\r\n    // }\r\n  })\r\n}\r\n\r\n// 获取用户的频道\r\nexport const getUserChannel = () => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user/channels'\r\n\r\n  })\r\n}\r\n\r\n// 关注用户\r\nexport const addFollow = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/user/followings',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n// 取消关注用户\r\nexport const CancelFollow = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/user/followings/${target}`\r\n\r\n  })\r\n}\r\n\r\n// 添加收藏\r\nexport const addCollect = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/article/collections',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n// 取消添加收藏\r\nexport const CancelCollect = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/article/collections/${target}`\r\n\r\n  })\r\n}\r\n\r\n// 点赞\r\nexport const addLike = target => {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/article/likings',\r\n    data: {\r\n      target\r\n    }\r\n  })\r\n}\r\n\r\n// 取消点赞\r\nexport const CancelLike = target => {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: `/v1_0/article/likings/${target}`\r\n\r\n  })\r\n}\r\n\r\n// 获取用户个人资料\r\nexport const getUserProfile = () => {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user/profile'\r\n\r\n  })\r\n}\r\n\r\n// 编辑用户个人资料\r\nexport const updateUserProfile = data => {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/profile',\r\n    data\r\n  })\r\n}\r\n\r\n// 编辑用户照片资料\r\nexport const updateUserPhoto = data => {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/photo',\r\n    data\r\n  })\r\n}\r\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","$event","$router","back","slot","ref","onSubmit","userFormRules","mobile","model","value","user","callback","$$v","$set","expression","code","scopedSlots","_u","key","fn","countDownVisible","sendMsg","_v","proxy","staticRenderFns","name","data","required","message","pattern","methods","duration","forbidClick","console","component","login","request","method","url","sendCode","getUserInfo","getUserChannel","addFollow","target","CancelFollow","addCollect","CancelCollect","addLike","CancelLike","getUserProfile","updateUserProfile","updateUserPhoto"],"sourceRoot":""}